import pytest
import rosalind.iotools


def test_parse_fasta():
    sequence = 'MKNKFKTQEELVNHLKTVGFVFANSEIYNGLANAWDYGPLGVLLKNNLKNLWWKEFVTKQKDVVGLDSAIILNPLVWKASGHLDNFSDPLIDCKNCKARYRADKLIESFDENIHIAENSSNEEFAKVLNDYEISCPTCKQFNWTEIRHFNLMFKTYQGVIEDAKNVVYLRPETAQGIFVNFKNVQRSMRLHLPFGIAQIGKSFRNEITPGNFIFRTREFEQMEIEFFLKEESAYDIFDKYLNQIENWLVSACGLSLNNLRKHEHPKEELSHYSKKTIDFEYNFLHGFSELYGIAYRTNYDLSVHMNLSKKDLTYFDEQTKEKYVPHVIEPSVGVERLLYAILTEATFIEKLENDDERILMDLKYDLAPYKIAVMPLVNKLKDKAEEIYGKILDLNISATFDNSGSIGKRYRRQDAIGTIYCLTIDFDSLDDQQDPSFTIRERNSMAQKRIKLSELPLYLNQKAHEDFQRQCQK'
    fasta = '>sp|B5ZC00|SYG_UREU1 Glycine--tRNA ligase OS=Ureaplasma urealyticum serovar 10 (strain ATCC 33699 / Western) GN=glyQS PE=3 SV=1\nMKNKFKTQEELVNHLKTVGFVFANSEIYNGLANAWDYGPLGVLLKNNLKNLWWKEFVTKQ\nKDVVGLDSAIILNPLVWKASGHLDNFSDPLIDCKNCKARYRADKLIESFDENIHIAENSS\nNEEFAKVLNDYEISCPTCKQFNWTEIRHFNLMFKTYQGVIEDAKNVVYLRPETAQGIFVN\nFKNVQRSMRLHLPFGIAQIGKSFRNEITPGNFIFRTREFEQMEIEFFLKEESAYDIFDKY\nLNQIENWLVSACGLSLNNLRKHEHPKEELSHYSKKTIDFEYNFLHGFSELYGIAYRTNYD\nLSVHMNLSKKDLTYFDEQTKEKYVPHVIEPSVGVERLLYAILTEATFIEKLENDDERILM\nDLKYDLAPYKIAVMPLVNKLKDKAEEIYGKILDLNISATFDNSGSIGKRYRRQDAIGTIY\nCLTIDFDSLDDQQDPSFTIRERNSMAQKRIKLSELPLYLNQKAHEDFQRQCQK'
    assert rosalind.iotools.parse_fasta(fasta)[1] == sequence


@pytest.mark.skip
def test_read_complete_fasta():
    fp = open('data/rosalind_cons.txt', 'r')
    fasta = rosalind.iotools.read_complete_fasta(fp)
    sequence = 'TAAACGCTCGATCTACCCTACCCCGCATGTCAAGTGCGTTCGTAAGAGTCCAACGTGGCTCACGCGGCGGGTTATCACTAGGACTTAGAAATAACAAAGCCGGAGCGCACGTCTGCGTAATTTGATCGCGGCGGGACCGAAACTATGAGAGAGCTTGGCAGCGGGCTATATGGATTTGACTAACATGATCCCACCGGCGATAGCGTTGACTTACAAAGCTCTCATGTCTTAAGCTCATGCTTGAGTATGTGCAACTGGAAAACTCTCCTGAGATGAAGCATAACTGCTTCCTCGTGTAACCCACATACGTACACTTACTACGCAAATATTCACTACAGAGTACAACACCGACTCGTGGTGGACTAGTAAGTTTGGTGACCTCCCGGGACAGACACAAGGCGTGCTCCCTCGTGAGACCTATCAGCCTGATCTTGCGTACATGGGCTACGGGAGCAGGAAAATACGCCTGATAGGCCAGCACCGGGGCTGCGTACGCAATTATAGTGAGGGGTAAGGTTTTGATGCTTTGCTCTCGTAGACACAATGGTGAATAATAATCTATGAACATAAAATTCGGAGATATTTACCTCTGTGGGGTGCGGGGGGGGCCGATTCTCCAATGTAGTCGCTAGATGATGTTGTAGTCGGGGCCAGGATTGGCTGATGTTCATCTATTGACCCTAGAGGTCGTCTCCAACTAGTGAAAACGGACAAGATGCGCAAGCAAGAGGCATAATGCGGTGTTTCTTTCTAGTGTCGAGATCTATCCACATACGGACGTAGCACAGATTGTAGTGTGGAGGGCGCAATCCTGAAATATCACCGCCCTAGACATCAATGACTCCGACATCCGGGAATAAAACAACGATTATGATCCCGATAGTCCGGGGCCAGATGATGGGGGCTGGAACATAAGCAACTCCATTTGGCACCTTGACGGTCGCTATATCTGCCCCTGGTATATAAGTCTATCGTTAATCCAAACCGATGCT'
    assert sequence == fasta[1][1]
    fp.close()

    fp = open('data/fasta_sample.txt', 'r')
    fasta = rosalind.iotools.read_complete_fasta(fp)
    answer = ('>testing', 'the fasta function')
    assert answer == fasta[0]
